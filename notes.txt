import os
import csv

# Function to update Week_Number column in CSV files
def update_week_number(folder_path, folder_name):
    for file_name in os.listdir(folder_path):
        if file_name.endswith('.csv') and file_name not in ["Executive_Summary_Table.csv", "L2C Enabled Revenue (created pipeline).csv"]:
            file_path = os.path.join(folder_path, file_name)
            with open(file_path, 'r', newline='') as csvfile:
                csv_reader = csv.DictReader(csvfile)
                rows = list(csv_reader)
                for row in rows:
                    row['Week_Number'] = folder_name
            with open(file_path, 'w', newline='') as csvfile:
                fieldnames = csv_reader.fieldnames
                csv_writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
                csv_writer.writeheader()
                csv_writer.writerows(rows)

# Main function to iterate through folders
def main():
    for i in range(1, 14):
        folder_name = str(i)
        folder_path = os.path.join('2.l2c', folder_name)
        if os.path.exists(folder_path):
            update_week_number(folder_path, folder_name)

if __name__ == "__main__":
    main()

# Create a copy of df with year decremented by 1 and forecast_flag set to 0
new_df = df.copy()
new_df['year'] = new_df['year'] - 1
new_df['forecast_flag'] = 0

# Add a new column 'previous YTD Closed Win (Vol)' to the original dataframe df
# containing YTD Closed Win (Vol) values from the newly created dataframe new_df
df['previous YTD Closed Win (Vol)'] = df.merge(new_df, on=['BU', 'month', 'year'], how='left')['YTD Closed Win (Vol)_y']

# Rename the column to remove the '_y' suffix
df.rename(columns={'previous YTD Closed Win (Vol)': 'previous YTD Closed Win (Vol)'}, inplace=True)

# Now df contains the 'previous YTD Closed Win (Vol)' column with values from the newly created dataframe new_df
